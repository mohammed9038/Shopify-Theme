{%- comment -%}
  Professional Custom Header for Dawn Theme
  
  This section provides a flexible and customizable header with features like:
  - Multiple layout options (standard, centered, expanded, minimal)
  - Customizable announcement bar
  - Responsive navigation with dropdowns
  - Search, account, and cart functionality
  - Mobile-friendly design
  
  @author: Copilot
  @version: 1.0.0
{%- endcomment -%}

{%- liquid 
  assign layout_class = 'header-layout-' | append: section.settings.layout_style
  assign is_sticky = section.settings.sticky_header
-%}

{%- style -%}
  #shopify-section-{{ section.id }} {
    --header-bg-color: {{ section.settings.bg_color }};
    --header-text-color: {{ section.settings.text_color }};
    --header-accent-color: {{ section.settings.accent_color }};
    --header-padding-v: {{ section.settings.padding_vertical }}px;
    --header-padding-h: {{ section.settings.padding_horizontal }}px;
    --header-logo-width: {{ section.settings.logo_max_width }}px;
    --announcement-bg-color: {{ section.settings.announcement_bg }};
    --announcement-text-color: {{ section.settings.announcement_text_color }};

    {% if section.settings.use_border %}
      --header-border-style: {{ section.settings.border_style }};
      --header-border-width: {{ section.settings.border_thickness }}px;
      --header-border-color: {{ section.settings.border_color }};
    {% else %}
      --header-border-style: none;
      --header-border-width: 0;
    {% endif %}
    
    {% if section.settings.use_shadow %}
      --header-shadow: 0 2px 10px rgba(0,0,0,0.1);
    {% else %}
      --header-shadow: none;
    {% endif %}
  }
{%- endstyle -%}
  
  .custom-header {
    background-color: var(--header-bg-color);
    color: var(--header-text-color);
    position: relative;
    z-index: 100;
    width: 100%;
  }
  
  .custom-header a {
    color: var(--header-text-color);
    text-decoration: none;
  }
  
  .sticky-header {
    position: sticky;
    top: 0;
    z-index: 100;
  }
  
  .announcement-bar {
    background-color: var(--announcement-bg-color);
    color: var(--announcement-text-color);
    text-align: center;
    padding: 10px var(--header-padding-h);
  }
  
  .announcement-bar p, .announcement-bar a {
    margin: 0;
    color: var(--announcement-text-color);
  }
  
  .header-main {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: var(--header-padding-v) var(--header-padding-h);
    border-bottom: var(--header-border-width) var(--header-border-style) var(--header-border-color);
    box-shadow: var(--header-shadow);
  }
  
  .header-logo {
    display: flex;
    align-items: center;
  }
  
  .header-logo img {
    max-width: var(--header-logo-width);
    height: auto;
    display: block;
  }
  
  /* Layout styles */
  .header-layout-standard .header-main {
    display: grid;
    grid-template-columns: 1fr auto 1fr;
  }
  
  .header-layout-standard .header-logo {
    grid-column: 2;
    justify-content: center;
  }
  
  .header-layout-standard .header-nav {
    grid-column: 1;
    justify-content: flex-start;
  }
  
  .header-layout-standard .header-actions {
    grid-column: 3;
    justify-content: flex-end;
  }
  
  .header-layout-centered .header-main {
    flex-direction: column;
  }
  
  .header-layout-centered .header-logo {
    margin-bottom: 15px;
  }
  
  .header-layout-expanded .header-main {
    padding-left: 40px;
    padding-right: 40px;
    max-width: 100%;
  }
  
  .header-layout-minimal .header-main {
    padding: 10px var(--header-padding-h);
  }
  
  /* Navigation */
  .header-nav {
    display: flex;
    align-items: center;
  }
  
  .header-menu {
    display: flex;
    list-style: none;
    margin: 0;
    padding: 0;
  }
  
  .header-menu-item {
    margin-right: 20px;
    position: relative;
  }
  
  .header-menu-link {
    display: block;
    padding: 5px 0;
    transition: color 0.2s;
  }
  
  .header-menu-link:hover {
    color: var(--header-accent-color);
  }
  
  .header-submenu {
    position: absolute;
    top: 100%;
    left: 0;
    background: var(--header-bg-color);
    min-width: 180px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    opacity: 0;
    visibility: hidden;
    transform: translateY(10px);
    transition: all 0.3s ease;
    z-index: 10;
    list-style: none;
    padding: 10px 0;
    margin: 0;
  }
  
  .header-menu-item:hover .header-submenu {
    opacity: 1;
    visibility: visible;
    transform: translateY(0);
  }
  
  .header-submenu-item {
    padding: 0;
    margin: 0;
  }
  
  .header-submenu-link {
    display: block;
    padding: 8px 15px;
    white-space: nowrap;
  }
  
  /* Header Actions */
  .header-actions {
    display: flex;
    align-items: center;
    gap: 15px;
  }
  
  .header-action-item {
    position: relative;
  }
  
  .header-search-toggle,
  .header-account-link,
  .header-cart-link {
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 5px;
    background: none;
    border: none;
    cursor: pointer;
    color: var(--header-text-color);
  }
  
  .header-search-toggle svg,
  .header-account-link svg,
  .header-cart-link svg {
    width: 20px;
    height: 20px;
  }
  
  .header-cart-count {
    position: absolute;
    top: -8px;
    right: -8px;
    background: var(--header-accent-color);
    color: #fff;
    font-size: 10px;
    font-weight: bold;
    width: 16px;
    height: 16px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
  }
  
  .header-search-form {
    position: absolute;
    top: calc(100% + 10px);
    right: 0;
    width: 300px;
    background: var(--header-bg-color);
    padding: 15px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    display: none;
    z-index: 11;
  }
  
  .header-search-input {
    width: 100%;
    padding: 10px;
    border: 1px solid var(--header-border-color);
    border-radius: 4px;
  }
  
  .mobile-menu-toggle {
    display: none;
    background: none;
    border: none;
    padding: 5px;
    cursor: pointer;
  }
  
  .mobile-menu-toggle svg {
    width: 24px;
    height: 24px;
    color: var(--header-text-color);
  }
  
  /* Mobile Styles */
  @media screen and (max-width: 990px) {
    .header-nav {
      display: none;
    }
    
    .mobile-menu-toggle {
      display: block;
    }
    
    .header-layout-standard .header-main {
      display: flex;
      justify-content: space-between;
    }
    
    .header-layout-standard .header-logo {
      order: 1;
    }
    
    .mobile-menu-toggle {
      order: 0;
    }
    
    .header-actions {
      order: 2;
    }
    
    .header-layout-centered .header-main {
      flex-direction: row;
      justify-content: space-between;
    }
    
    .header-layout-centered .header-logo {
      margin-bottom: 0;
    }
  }
{%- endstyle -%}

<div class="custom-header {{ layout_class }}">
  {% if section.settings.show_announcement and section.settings.announcement_text != blank %}
    <div class="announcement-bar">
      <div class="page-width">
        {% if section.settings.announcement_link != blank %}
          <a href="{{ section.settings.announcement_link }}">
            <p>{{ section.settings.announcement_text }}</p>
          </a>
        {% else %}
          <p>{{ section.settings.announcement_text }}</p>
        {% endif %}
      </div>
    </div>
  {% endif %}
  
  <div class="{% if is_sticky %}sticky-header{% endif %}">
    <div class="header-main">
      <button type="button" class="mobile-menu-toggle" aria-expanded="false">
        <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" role="presentation" fill="none" viewBox="0 0 18 16">
          <path d="M1 .5a.5.5 0 0 0 0 1h16a.5.5 0 0 0 0-1H1Z" fill="currentColor">
          </path>
          <path d="M1 7.5a.5.5 0 0 0 0 1h16a.5.5 0 0 0 0-1H1Z" fill="currentColor">
          </path>
          <path d="M1 14.5a.5.5 0 0 0 0 1h16a.5.5 0 0 0 0-1H1Z" fill="currentColor">
          </path>
        </svg>
        <span class="visually-hidden">Menu</span>
      </button>
      
      <div class="header-logo">
        {% if section.settings.logo != blank %}
          <a href="{{ routes.root_url }}">
            <img 
              src="{{ section.settings.logo | image_url: width: section.settings.logo_max_width }}" 
              alt="{{ section.settings.logo.alt | default: shop.name }}" 
              width="{{ section.settings.logo_max_width }}"
              height=""
              loading="lazy">
          </a>
        {% else %}
          <a href="{{ routes.root_url }}" class="h3">{{ shop.name }}</a>
        {% endif %}
      </div>
      
      <nav class="header-nav" style="text-align: {{ section.settings.menu_alignment }}">
        {% if section.settings.menu != blank %}
          <ul class="header-menu">
            {% for link in linklists[section.settings.menu].links %}
              <li class="header-menu-item">
                <a href="{{ link.url }}" class="header-menu-link">
                  {{ link.title }}
                </a>
                {% if link.links.size > 0 %}
                  <ul class="header-submenu">
                    {% for childlink in link.links %}
                      <li class="header-submenu-item">
                        <a href="{{ childlink.url }}" class="header-submenu-link">
                          {{ childlink.title }}
                        </a>
                      </li>
                    {% endfor %}
                  </ul>
                {% endif %}
              </li>
            {% endfor %}
          </ul>
        {% endif %}
      </nav>
      
      <div class="header-actions">
        {% if section.settings.show_search %}
          <div class="header-action-item">
            <button type="button" class="header-search-toggle" aria-label="Search">
              <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" fill="none" viewBox="0 0 20 20">
                <path fill-rule="evenodd" clip-rule="evenodd" d="M13.6667 8.33332C13.6667 11.278 11.278 13.6666 8.33333 13.6666C5.38868 13.6666 3 11.278 3 8.33332C3 5.38868 5.38868 2.99999 8.33333 2.99999C11.278 2.99999 13.6667 5.38868 13.6667 8.33332ZM12.7599 14.5428C11.4653 15.4789 9.88567 16 8.33333 16C4.10203 16 0.666668 12.5646 0.666668 8.33332C0.666668 4.10201 4.10203 0.666656 8.33333 0.666656C12.5646 0.666656 16 4.10201 16 8.33332C16 9.88566 15.4789 11.4653 14.5429 12.7598L19.0893 17.3062L17.3062 19.0893L12.7599 14.5428Z" fill="currentColor"/>
              </svg>
            </button>
            <div class="header-search-form" hidden>
              <form action="{{ routes.search_url }}" method="get" role="search">
                <input type="search" name="q" placeholder="Search" class="header-search-input">
              </form>
            </div>
          </div>
        {% endif %}
        
        {% if section.settings.show_account and shop.customer_accounts_enabled %}
          <div class="header-action-item">
            <a href="{{ routes.account_url }}" class="header-account-link">
              <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" fill="none" viewBox="0 0 18 19">
                <path fill-rule="evenodd" clip-rule="evenodd" d="M9 .5C6.37665.5 4.25 2.62665 4.25 5.25c0 1.63606.8064 3.0843 2.04127 3.96891C2.96533 10.6033.75 13.7222.75 17.25h1.5c0-3.7279 3.02208-6.75 6.75-6.75 3.7279 0 6.75 3.0221 6.75 6.75h1.5c0-3.5278-2.2153-6.6467-5.5413-8.03109C13.1936 8.3343 14 6.88606 14 5.25 14 2.62665 11.8734.5 9 .5Zm0 1.5c1.79493 0 3.25 1.45507 3.25 3.25S10.7949 8.5 9 8.5 5.75 7.04493 5.75 5.25 7.20507 2 9 2Z" fill="currentColor"/>
              </svg>
            </a>
          </div>
        {% endif %}
        
        {% if section.settings.show_cart %}
          <div class="header-action-item">
            <a href="{{ routes.cart_url }}" class="header-cart-link">
              <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" fill="none" viewBox="0 0 20 20">
                <path fill-rule="evenodd" clip-rule="evenodd" d="M3.66675 3.33334H0.333252V1.00001H5.16675L5.98324 3.33334H18.6667L16.0001 12.3333H5.66675L2.16675 1.00001H0.333252V0.333344H2.81325L6.31325 11.6667H15.0447L17.1113 4.00001H6.31325L5.49675 1.66668H3.66675V3.33334ZM5.66675 13.6667C4.56218 13.6667 3.66675 14.5621 3.66675 15.6667C3.66675 16.7712 4.56218 17.6667 5.66675 17.6667C6.77132 17.6667 7.66675 16.7712 7.66675 15.6667C7.66675 14.5621 6.77132 13.6667 5.66675 13.6667ZM16.0001 13.6667C14.8955 13.6667 14.0001 14.5621 14.0001 15.6667C14.0001 16.7712 14.8955 17.6667 16.0001 17.6667C17.1046 17.6667 18.0001 16.7712 18.0001 15.6667C18.0001 14.5621 17.1046 13.6667 16.0001 13.6667ZM5.66675 15C5.29856 15 5.00008 15.2985 5.00008 15.6667C5.00008 16.0349 5.29856 16.3333 5.66675 16.3333C6.03494 16.3333 6.33341 16.0349 6.33341 15.6667C6.33341 15.2985 6.03494 15 5.66675 15ZM15.3334 15.6667C15.3334 15.2985 15.6319 15 16.0001 15C16.3682 15 16.6667 15.2985 16.6667 15.6667C16.6667 16.0349 16.3682 16.3333 16.0001 16.3333C15.6319 16.3333 15.3334 16.0349 15.3334 15.6667Z" fill="currentColor"/>
              </svg>
              <span class="header-cart-count{% if cart.item_count == 0 %} is-empty{% endif %}">
                {{ cart.item_count }}
              </span>
            </a>
          </div>
        {% endif %}
      </div>
    </div>
  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    // Search toggle functionality
    const searchToggle = document.querySelector('.header-search-toggle');
    const searchForm = document.querySelector('.header-search-form');
    
    if (searchToggle && searchForm) {
      searchToggle.addEventListener('click', function() {
        const isHidden = searchForm.hasAttribute('hidden');
        if (isHidden) {
          searchForm.removeAttribute('hidden');
          searchToggle.setAttribute('aria-expanded', 'true');
          searchForm.querySelector('input').focus();
        } else {
          searchForm.setAttribute('hidden', '');
          searchToggle.setAttribute('aria-expanded', 'false');
        }
      });
      
      // Close search when clicking outside
      document.addEventListener('click', function(e) {
        if (!searchForm.contains(e.target) && !searchToggle.contains(e.target) && !searchForm.hasAttribute('hidden')) {
          searchForm.setAttribute('hidden', '');
          searchToggle.setAttribute('aria-expanded', 'false');
        }
      });
    }
    
    // Mobile menu functionality (would need to be expanded in a real implementation)
    const mobileMenuToggle = document.querySelector('.mobile-menu-toggle');
    if (mobileMenuToggle) {
      mobileMenuToggle.addEventListener('click', function() {
        // Mobile menu toggle logic would go here
        // This would typically involve showing/hiding a mobile menu drawer
        console.log('Mobile menu clicked');
      });
    }
  });
</script>

{% schema %}
{
  "name": "Professional Header",
  "settings": [
    {
      "type": "header",
      "content": "Layout & Structure"
    },
    {
      "type": "select",
      "id": "layout_style",
      "label": "Header layout",
      "options": [
        {
          "value": "standard",
          "label": "Standard"
        },
        {
          "value": "centered",
          "label": "Centered logo"
        },
        {
          "value": "expanded",
          "label": "Full width"
        },
        {
          "value": "minimal",
          "label": "Minimal"
        }
      ],
      "default": "standard"
    },
    {
      "type": "checkbox",
      "id": "show_announcement",
      "label": "Show announcement bar",
      "default": false
    },
    {
      "type": "text",
      "id": "announcement_text",
      "label": "Announcement text",
      "default": "Free shipping on all orders over $75"
    },
    {
      "type": "url",
      "id": "announcement_link",
      "label": "Announcement link"
    },
    {
      "type": "color",
      "id": "announcement_bg",
      "label": "Background color",
      "default": "#121212"
    },
    {
      "type": "color",
      "id": "announcement_text_color",
      "label": "Text color",
      "default": "#ffffff"
    },
    {
      "type": "header",
      "content": "Logo"
    },
    {
      "type": "image_picker",
      "id": "logo",
      "label": "Logo image"
    },
    {
      "type": "range",
      "id": "logo_max_width",
      "min": 50,
      "max": 300,
      "step": 10,
      "default": 150,
      "unit": "px",
      "label": "Custom logo width"
    },
    {
      "type": "header",
      "content": "Navigation"
    },
    {
      "type": "link_list",
      "id": "menu",
      "label": "Menu",
      "default": "main-menu"
    },
    {
      "type": "select",
      "id": "menu_alignment",
      "label": "Menu alignment",
      "options": [
        {
          "value": "left",
          "label": "Left"
        },
        {
          "value": "center",
          "label": "Center"
        },
        {
          "value": "right",
          "label": "Right"
        }
      ],
      "default": "center"
    },
    {
      "type": "header",
      "content": "Colors"
    },
    {
      "type": "color",
      "id": "bg_color",
      "label": "Background color",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "Text color",
      "default": "#121212"
    },
    {
      "type": "color",
      "id": "accent_color",
      "label": "Accent color",
      "default": "#3a3a3a"
    },
    {
      "type": "header",
      "content": "Header Features"
    },
    {
      "type": "checkbox",
      "id": "sticky_header",
      "label": "Enable sticky header",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_search",
      "label": "Show search",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_account",
      "label": "Show account",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_cart",
      "label": "Show cart",
      "default": true
    },
    {
      "type": "header",
      "content": "Advanced Settings"
    },
    {
      "type": "range",
      "id": "padding_vertical",
      "min": 5,
      "max": 30,
      "step": 1,
      "default": 15,
      "unit": "px",
      "label": "Vertical padding"
    },
    {
      "type": "range",
      "id": "padding_horizontal",
      "min": 10,
      "max": 60,
      "step": 5,
      "default": 20,
      "unit": "px",
      "label": "Horizontal padding"
    },
    {
      "type": "checkbox",
      "id": "use_border",
      "label": "Show border",
      "default": true
    },
    {
      "type": "select",
      "id": "border_style",
      "label": "Border style",
      "options": [
        {
          "value": "solid",
          "label": "Solid"
        },
        {
          "value": "dashed",
          "label": "Dashed"
        },
        {
          "value": "dotted",
          "label": "Dotted"
        }
      ],
      "default": "solid"
    },
    {
      "type": "range",
      "id": "border_thickness",
      "min": 1,
      "max": 5,
      "step": 1,
      "default": 1,
      "unit": "px",
      "label": "Border thickness"
    },
    {
      "type": "color",
      "id": "border_color",
      "label": "Border color",
      "default": "#e8e8e8"
    },
    {
      "type": "checkbox",
      "id": "use_shadow",
      "label": "Enable shadow",
      "default": false
    }
  ],
  "presets": [
    {
      "name": "Professional Header",
      "settings": {}
    }
  ]
}
{% endschema %}