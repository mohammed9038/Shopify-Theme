{%- comment -%}
  Professional Header for Dawn Theme
  
  This section provides a flexible and customizable header with features like:
  - Multiple layout options (standard, centered, expanded, minimal)
  - Customizable announcement bar
  - Responsive navigation with dropdowns
  - Search, account, and cart functionality
  - Mobile-friendly design
  
  @version: 1.0.0
{%- endcomment -%}

{%- liquid 
  assign layout_class = 'header-layout-' | append: section.settings.layout_style
  assign is_sticky = section.settings.sticky_header
-%}

{% style %}
  #shopify-section-{{ section.id }} {
    --header-bg-color: {{ section.settings.bg_color }};
    --header-text-color: {{ section.settings.text_color }};
    --header-accent-color: {{ section.settings.accent_color }};
    --header-padding-v: {{ section.settings.padding_vertical }}px;
    --header-padding-h: {{ section.settings.padding_horizontal }}px;
    --header-logo-width: {{ section.settings.logo_max_width }}px;
    --announcement-bg-color: {{ section.settings.announcement_bg }};
    --announcement-text-color: {{ section.settings.announcement_text_color }};
  }
  
  .custom-header {
    background-color: var(--header-bg-color);
    color: var(--header-text-color);
    padding: var(--header-padding-v) var(--header-padding-h);
    position: relative;
    z-index: 5;
  }
  
  .custom-header--sticky {
    position: sticky;
    top: 0;
    transition: transform 0.3s ease;
  }
  
  .custom-header__announcement {
    background-color: var(--announcement-bg-color);
    color: var(--announcement-text-color);
    padding: 10px var(--header-padding-h);
    text-align: center;
    font-size: 0.85rem;
  }
  
  .custom-header__main {
    display: flex;
    align-items: center;
    justify-content: space-between;
  }
  
  .custom-header__logo-container {
    display: flex;
    align-items: center;
    flex: 1;
  }
  
  .custom-header__logo {
    max-width: var(--header-logo-width);
    width: 100%;
  }
  
  .custom-header__logo img {
    display: block;
    width: 100%;
  }
  
  .custom-header__nav-container {
    flex: 2;
    display: flex;
    justify-content: center;
  }
  
  .custom-header__actions {
    display: flex;
    align-items: center;
    gap: 1rem;
    flex: 1;
    justify-content: flex-end;
  }
  
  .custom-header__menu {
    display: flex;
    list-style: none;
    margin: 0;
    padding: 0;
    gap: 1.5rem;
  }
  
  .custom-header__menu-item {
    position: relative;
  }
  
  .custom-header__menu-link {
    color: var(--header-text-color);
    text-decoration: none;
    font-weight: 500;
    display: inline-block;
    padding: 0.25rem 0;
    transition: color 0.2s ease;
  }
  
  .custom-header__menu-link:hover {
    color: var(--header-accent-color);
  }
  
  .custom-header__action-link {
    color: var(--header-text-color);
    display: flex;
    align-items: center;
    text-decoration: none;
    transition: color 0.2s ease;
  }
  
  .custom-header__action-link:hover {
    color: var(--header-accent-color);
  }
  
  .custom-header__action-icon {
    width: 1.25rem;
    height: 1.25rem;
  }
  
  .custom-header__mobile-menu-toggle,
  .custom-header__search-toggle {
    background: none;
    border: none;
    color: var(--header-text-color);
    cursor: pointer;
    padding: 0.5rem;
    display: none;
  }
  
  @media screen and (max-width: 990px) {
    .custom-header__nav-container {
      display: none;
    }
    
    .custom-header__mobile-menu-toggle {
      display: block;
    }
  }
  
  .header-layout-centered .custom-header__logo-container {
    justify-content: center;
    order: 2;
  }
  
  .header-layout-centered .custom-header__nav-container {
    order: 1;
  }
  
  .header-layout-centered .custom-header__actions {
    order: 3;
  }
  
  .header-layout-minimal .custom-header__main {
    justify-content: center;
  }
  
  .header-layout-minimal .custom-header__actions {
    position: absolute;
    right: var(--header-padding-h);
  }
  
  .header-layout-expanded .custom-header__main {
    flex-wrap: wrap;
  }
  
  .header-layout-expanded .custom-header__logo-container {
    width: 100%;
    justify-content: center;
    margin-bottom: 1rem;
  }
  
  .header-layout-expanded .custom-header__nav-container {
    justify-content: center;
    flex: auto;
  }
{% endstyle %}

<div class="custom-header {% if is_sticky %}custom-header--sticky{% endif %} {{ layout_class }}">
  {%- if section.settings.show_announcement and section.settings.announcement_text != blank -%}
    <div class="custom-header__announcement">
      <p>{{ section.settings.announcement_text }}</p>
    </div>
  {%- endif -%}
  
  <div class="custom-header__main">
    <button class="custom-header__mobile-menu-toggle" aria-expanded="false">
      <span class="visually-hidden">{{ 'sections.header.menu' | t }}</span>
      <svg aria-hidden="true" focusable="false" class="custom-header__action-icon" viewBox="0 0 24 24">
        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
      </svg>
    </button>
    
    <div class="custom-header__logo-container">
      <a href="{{ routes.root_url }}" class="custom-header__logo">
        {%- if section.settings.logo != blank -%}
          {%- assign logo_alt = section.settings.logo.alt | default: shop.name | escape -%}
          {%- assign logo_width = section.settings.logo_max_width -%}
          {{ section.settings.logo | image_url: width: 450 | image_tag:
            loading: 'lazy',
            width: logo_width,
            height: logo_width | divided_by: section.settings.logo.aspect_ratio,
            alt: logo_alt,
            class: 'header__heading-logo'
          }}
        {%- else -%}
          <span class="h2">{{ shop.name }}</span>
        {%- endif -%}
      </a>
    </div>
    
    <div class="custom-header__nav-container">
      {%- if section.settings.menu != blank -%}
        <nav>
          <ul class="custom-header__menu">
            {%- for link in linklists[section.settings.menu].links -%}
              <li class="custom-header__menu-item">
                <a href="{{ link.url }}" class="custom-header__menu-link">{{ link.title }}</a>
              </li>
            {%- endfor -%}
          </ul>
        </nav>
      {%- endif -%}
    </div>
    
    <div class="custom-header__actions">
      <button class="custom-header__search-toggle">
        <span class="visually-hidden">{{ 'sections.header.search' | t }}</span>
        <svg aria-hidden="true" focusable="false" class="custom-header__action-icon" viewBox="0 0 24 24">
          <path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/>
        </svg>
      </button>
      
      <a href="{{ routes.account_url }}" class="custom-header__action-link">
        <span class="visually-hidden">{{ 'sections.header.account' | t }}</span>
        <svg aria-hidden="true" focusable="false" class="custom-header__action-icon" viewBox="0 0 24 24">
          <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z"/>
        </svg>
      </a>
      
      <a href="{{ routes.cart_url }}" class="custom-header__action-link">
        <span class="visually-hidden">{{ 'sections.header.cart' | t }}</span>
        <svg aria-hidden="true" focusable="false" class="custom-header__action-icon" viewBox="0 0 24 24">
          <path d="M7 18c-1.1 0-1.99.9-1.99 2S5.9 22 7 22s2-.9 2-2-.9-2-2-2zM1 2v2h2l3.6 7.59-1.35 2.45c-.16.28-.25.61-.25.96 0 1.1.9 2 2 2h12v-2H7.42c-.14 0-.25-.11-.25-.25l.03-.12.9-1.63h7.45c.75 0 1.41-.41 1.75-1.03l3.58-6.49c.08-.14.12-.31.12-.48 0-.55-.45-1-1-1H5.21l-.94-2H1zm16 16c-1.1 0-1.99.9-1.99 2s.89 2 1.99 2 2-.9 2-2-.9-2-2-2z"/>
        </svg>
        <span class="cart-count-bubble">
          {%- if cart.item_count > 0 -%}
            <span aria-hidden="true">{{ cart.item_count }}</span>
          {%- endif -%}
        </span>
      </a>
    </div>
  </div>
</div>

{% javascript %}
  document.addEventListener('DOMContentLoaded', function() {
    // Mobile menu toggle functionality
    const mobileMenuToggle = document.querySelector('.custom-header__mobile-menu-toggle');
    if (mobileMenuToggle) {
      // Add mobile menu toggle functionality when needed
    }
    
    // Search toggle functionality
    const searchToggle = document.querySelector('.custom-header__search-toggle');
    if (searchToggle) {
      // Add search toggle functionality when needed
    }
  });
{% endjavascript %}

{% schema %}
{
  "name": "Header",
  "settings": [
    {
      "type": "header",
      "content": "Layout Settings"
    },
    {
      "type": "select",
      "id": "layout_style",
      "label": "Layout style",
      "options": [
        {
          "value": "standard",
          "label": "Standard"
        },
        {
          "value": "centered",
          "label": "Centered"
        },
        {
          "value": "expanded",
          "label": "Expanded"
        },
        {
          "value": "minimal",
          "label": "Minimal"
        }
      ],
      "default": "standard"
    },
    {
      "type": "checkbox",
      "id": "sticky_header",
      "label": "Enable sticky header",
      "default": true
    },
    {
      "type": "header",
      "content": "Announcement Bar"
    },
    {
      "type": "checkbox",
      "id": "show_announcement",
      "label": "Show announcement",
      "default": false
    },
    {
      "type": "text",
      "id": "announcement_text",
      "label": "Announcement text",
      "default": "Free shipping on all orders over $75"
    },
    {
      "type": "color",
      "id": "announcement_bg",
      "label": "Background",
      "default": "#121212"
    },
    {
      "type": "color",
      "id": "announcement_text_color",
      "label": "Text",
      "default": "#ffffff"
    },
    {
      "type": "header",
      "content": "Logo"
    },
    {
      "type": "image_picker",
      "id": "logo",
      "label": "Logo image"
    },
    {
      "type": "range",
      "id": "logo_max_width",
      "min": 50,
      "max": 300,
      "step": 10,
      "unit": "px",
      "label": "Logo width",
      "default": 140
    },
    {
      "type": "header",
      "content": "Menu"
    },
    {
      "type": "link_list",
      "id": "menu",
      "label": "Menu",
      "default": "main-menu"
    },
    {
      "type": "header",
      "content": "Colors"
    },
    {
      "type": "color",
      "id": "bg_color",
      "label": "Background",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "Text",
      "default": "#121212"
    },
    {
      "type": "color",
      "id": "accent_color",
      "label": "Accent",
      "default": "#9b59b6"
    },
    {
      "type": "header",
      "content": "Spacing"
    },
    {
      "type": "range",
      "id": "padding_vertical",
      "min": 5,
      "max": 30,
      "step": 1,
      "unit": "px",
      "label": "Vertical padding",
      "default": 15
    },
    {
      "type": "range",
      "id": "padding_horizontal",
      "min": 10,
      "max": 50,
      "step": 2,
      "unit": "px",
      "label": "Horizontal padding",
      "default": 30
    }
  ]
}
{% endschema %}
