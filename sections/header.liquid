<link rel="stylesheet" href="{{ 'shopify-header.css' | asset_url }}">
<link rel="stylesheet" href="{{ 'mega-menu.css' | asset_url }}">

{%- liquid
  assign header_tag = 'header'
  if section.settings.sticky_header_type == 'always' or section.settings.sticky_header_type == 'on-scroll-up'
    assign header_tag = 'sticky-header'
  endif
-%}

<style>
  :root {
    --logo-width: {{ section.settings.logo_width }};
  }
</style>

<{{ header_tag }}
  {% if header_tag == 'sticky-header' %}
    data-sticky-type="{{ section.settings.sticky_header_type }}"
  {% endif %}
  class="shopify-header header-layout-{{ section.settings.desktop_layout }}"
  dir="{{ shop.locale.dir | default: 'ltr' }}"
>
  <header class="shopify-header-wrapper">
    
    {%- if section.settings.desktop_layout == 'two-row' and section.settings.show_top_bar -%}
      <!-- Top Navigation Bar -->
      <div class="shopify-topbar">
        <div class="shopify-container">
          {%- if section.settings.menu != blank -%}
            <nav class="shopify-nav">
              <ul class="shopify-menu{% if section.settings.menu_alignment %} menu-align-{{ section.settings.menu_alignment }}{% endif %}">
                {%- for link in section.settings.menu.links -%}
                  <li class="shopify-menu-item">
                    <a href="{{ link.url }}" class="shopify-menu-link">
                      {{ link.title | escape }}
                    </a>
                    {% if link.links.size > 0 and section.settings.enable_mega_menu %}
                      {% render 'mega-menu', link: link %}
                    {% endif %}
                  </li>
                {%- endfor -%}
              </ul>
            </nav>
          {%- endif -%}
        </div>
      </div>
    {%- endif -%}

    <!-- Main Header -->
    <div class="shopify-main-header">
      <div class="shopify-container">
        
        <!-- Left Section -->
        <div class="shopify-header-left">
          {%- comment -%} Show logo on left for two-row layout, or when single-row with logo_position left {%- endcomment -%}
          {%- if section.settings.desktop_layout == 'two-row' or section.settings.desktop_layout == 'single-row' and section.settings.logo_position == 'left' -%}
            <div class="shopify-logo">
              {%- if section.settings.logo != blank -%}
                <a href="{{ routes.root_url }}">
                  <img src="{{ section.settings.logo | image_url: width: section.settings.desktop_logo_width }}" alt="{{ shop.name }}" width="{{ section.settings.desktop_logo_width }}" height="auto" class="logo-dark">
                  
                  {%- if section.settings.logo_light != blank -%}
                    <img src="{{ section.settings.logo_light | image_url: width: section.settings.desktop_logo_width }}" alt="{{ shop.name }}" width="{{ section.settings.desktop_logo_width }}" height="auto" class="logo-light">
                  {%- else -%}
                    <img src="{{ section.settings.logo | image_url: width: section.settings.desktop_logo_width }}" alt="{{ shop.name }}" width="{{ section.settings.desktop_logo_width }}" height="auto" class="logo-light">
                  {%- endif -%}
                </a>
              {%- else -%}
                <a href="{{ routes.root_url }}" class="shopify-logo-text">{{ shop.name }}</a>
              {%- endif -%}
            </div>
          {%- endif -%}
          
          {%- comment -%} Only show navigation in left section for single-row layout {%- endcomment -%}
          {%- if section.settings.desktop_layout == 'single-row' and section.settings.menu != blank -%}
            <nav class="shopify-nav shopify-nav-single-row">
              <ul class="shopify-menu">
                {%- for link in section.settings.menu.links -%}
                  <li class="shopify-menu-item">
                    <a href="{{ link.url }}" class="shopify-menu-link">
                      {{ link.title | escape }}
                    </a>
                  </li>
                {%- endfor -%}
              </ul>
            </nav>
          {%- endif -%}
        </div>

        <!-- Center Section -->
        <div class="shopify-header-center">
          {%- comment -%} Only show logo in center for single-row layout when logo_position is center {%- endcomment -%}
          {%- if section.settings.desktop_layout == 'single-row' and section.settings.logo_position == 'center' -%}
            <div class="shopify-logo">
              {%- if section.settings.logo != blank -%}
                <a href="{{ routes.root_url }}">
                  <img src="{{ section.settings.logo | image_url: width: section.settings.desktop_logo_width }}" alt="{{ shop.name }}" width="{{ section.settings.desktop_logo_width }}" height="auto" class="logo-dark">
                  
                  {%- if section.settings.logo_light != blank -%}
                    <img src="{{ section.settings.logo_light | image_url: width: section.settings.desktop_logo_width }}" alt="{{ shop.name }}" width="{{ section.settings.desktop_logo_width }}" height="auto" class="logo-light">
                  {%- else -%}
                    <img src="{{ section.settings.logo | image_url: width: section.settings.desktop_logo_width }}" alt="{{ shop.name }}" width="{{ section.settings.desktop_logo_width }}" height="auto" class="logo-light">
                  {%- endif -%}
                </a>
              {%- else -%}
                <a href="{{ routes.root_url }}" class="shopify-logo-text">{{ shop.name }}</a>
              {%- endif -%}
            </div>
          {%- endif -%}
          
          {%- comment -%} Show search in center for two-row layout, or when search_position is center {%- endcomment -%}
          {%- assign show_center_search = false -%}
          {%- if section.settings.enable_search -%}
            {%- if section.settings.desktop_layout == 'two-row' -%}
              {%- assign show_center_search = true -%}
            {%- elsif section.settings.search_position == 'center' -%}
              {%- assign show_center_search = true -%}
            {%- endif -%}
          {%- endif -%}
          
          {%- if show_center_search -%}
            <div class="shopify-search">
              <form action="{{ routes.search_url }}" method="get" role="search" class="shopify-search-form{% if section.settings.stylized_search_button %} stylized-search-button{% endif %}">
                <input type="search" name="q" placeholder="{% if section.settings.search_placeholder != blank %}{{ section.settings.search_placeholder | escape }}{% else %}Search products, brands...{% endif %}" class="shopify-search-input">
                <button type="submit" class="shopify-search-button" aria-label="Search">
                  <svg viewBox="0 0 20 20" class="shopify-search-icon">
                    <path fill="currentColor" d="m18.366 16.95l-5.708-5.708a8.026 8.026 0 1 0-1.414 1.414l5.708 5.708a1 1 0 0 0 1.414-1.414ZM8 14A6 6 0 1 1 8 2a6 6 0 0 1 0 12Z"/>
                  </svg>
                </button>
              </form>
            </div>
          {%- endif -%}
        </div>

        <!-- Right Section -->
        <div class="shopify-header-right">
          {%- if section.settings.search_position == 'right' and section.settings.enable_search -%}
            <div class="shopify-search">
              <form action="{{ routes.search_url }}" method="get" role="search" class="shopify-search-form{% if section.settings.stylized_search_button %} stylized-search-button{% endif %}">
                <input type="search" name="q" placeholder="{% if section.settings.search_placeholder != blank %}{{ section.settings.search_placeholder | escape }}{% else %}Search products, brands...{% endif %}" class="shopify-search-input">
                <button type="submit" class="shopify-search-button" aria-label="Search">
                  <svg viewBox="0 0 20 20" class="shopify-search-icon">
                    <path fill="currentColor" d="m18.366 16.95l-5.708-5.708a8.026 8.026 0 1 0-1.414 1.414l5.708 5.708a1 1 0 0 0 1.414-1.414ZM8 14A6 6 0 1 1 8 2a6 6 0 0 1 0 12Z"/>
                  </svg>
                </button>
              </form>
            </div>
          {%- endif -%}

          <div class="shopify-icons{% if section.settings.show_icon_labels %} show-icon-labels{% endif %}">
            {%- if shop.customer_accounts_enabled and section.settings.enable_customer_avatar -%}
              <a href="{%- if customer -%}{{ routes.account_url }}{%- else -%}{{ routes.account_login_url }}{%- endif -%}" class="shopify-icon shopify-icon-account">
                <svg viewBox="0 0 20 20" class="shopify-icon-svg">
                  <path fill="currentColor" d="M17.1 16.9v-1a2 2 0 0 0-2-2H4.9a2 2 0 0 0-2 2v1a.5.5 0 0 0 1 0v-1a1 1 0 0 1 1-1h10.2a1 1 0 0 1 1 1v1a.5.5 0 0 0 1 0ZM10 2a4 4 0 1 0 0 8 4 4 0 0 0 0-8ZM7 6a3 3 0 1 1 6 0 3 3 0 0 1-6 0Z"/>
                </svg>
                <span class="shopify-icon-label">Account</span>
              </a>
            {%- endif -%}

            <a href="{{ routes.cart_url }}" class="shopify-icon shopify-icon-cart" id="shopify-cart-icon">
              <svg viewBox="0 0 20 20" class="shopify-icon-svg">
                <path fill="currentColor" d="M8.5 19a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3ZM19 7h-3V6a4 4 0 0 0-8 0v1H5a1 1 0 0 0-1 1v9a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V8a1 1 0 0 0-1-1ZM10 3a3 3 0 0 1 3 3v1h-6V6a3 3 0 0 1 3-3ZM6 17V9h2v8H6Zm4 0V9h2v8h-2Zm4 0V9h2v8h-2Z"/>
              </svg>
              <span class="shopify-icon-label">Cart</span>
              {%- if cart != empty -%}
                <span class="shopify-cart-count">{{ cart.item_count }}</span>
              {%- endif -%}
            </a>
            
            {%- if section.settings.enable_wishlist -%}
            <a href="/pages/wishlist" class="shopify-icon shopify-icon-wishlist">
              <svg viewBox="0 0 20 20" class="shopify-icon-svg">
                <path fill="currentColor" d="M10 18.166L9.212 17.498C4.736 13.598 1.875 11.102 1.875 8.014C1.875 5.517 3.808 3.584 6.305 3.584C7.698 3.584 9.029 4.251 9.999 5.321C10.969 4.251 12.301 3.584 13.694 3.584C16.192 3.584 18.124 5.517 18.124 8.014C18.124 11.102 15.264 13.598 10.788 17.508L10 18.166Z" stroke="currentColor" stroke-width="1.5" fill-opacity="0" />
              </svg>
              <span class="shopify-icon-label">Wishlist</span>
            </a>
            {%- endif -%}
            
            {%- if section.settings.enable_compare -%}
            <a href="/pages/compare" class="shopify-icon shopify-icon-compare">
              <svg viewBox="0 0 20 20" class="shopify-icon-svg">
                <path fill="currentColor" d="M6.5 9.5L4 7M4 7L6.5 4.5M4 7H13M13.5 10.5L16 13M16 13L13.5 15.5M16 13H7" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
              </svg>
              <span class="shopify-icon-label">Compare</span>
            </a>
            {%- endif -%}
          </div>

          {%- comment -%}
            Desktop localization selectors (language and/or country) – show when multiple options are available
          {%- endcomment -%}
          {%- if localization.available_languages.size > 1 or localization.available_countries.size > 1 -%}
            <div class="shopify-localization shopify-localization-desktop">
              {%- if localization.available_languages.size > 1 -%}
                <localization-form>
                  {%- form 'localization', id: 'HeaderLanguageForm', class: 'localization-form' -%}
                    <div class="localization-form__select">
                      <h2 class="visually-hidden" id="HeaderLanguageLabel">{{ 'localization.language_label' | t }}</h2>
                      <select class="localization-selector link" name="locale_code" aria-labelledby="HeaderLanguageLabel">
                        {%- for language in localization.available_languages -%}
                          <option value="{{ language.iso_code }}" lang="{{ language.iso_code }}"{%- if language.iso_code == localization.language.iso_code %} selected{% endif %}>
                            {{ language.endonym_name | capitalize }}
                          </option>
                        {%- endfor -%}
                      </select>
                      <span class="svg-wrapper">{{- 'icon-caret.svg' | inline_asset_content -}}</span>
                    </div>
                    <input type="hidden" name="return_to" value="{{ request.full_url }}">
                  {%- endform -%}
                </localization-form>
              {%- endif -%}

              {%- if localization.available_countries.size > 1 -%}
                <localization-form>
                  {%- form 'localization', id: 'HeaderCountryForm', class: 'localization-form' -%}
                    <div class="localization-form__select">
                      <h2 class="visually-hidden" id="HeaderCountryLabel">{{ 'localization.country_label' | t }}</h2>
                      <select class="localization-selector link" name="country_code" aria-labelledby="HeaderCountryLabel">
                        {%- for country in localization.available_countries -%}
                          <option value="{{ country.iso_code }}"{%- if country.iso_code == localization.country.iso_code %} selected{% endif %}>
                            {{ country.name }} ({{ country.currency.symbol }} {{ country.currency.iso_code }})
                          </option>
                        {%- endfor -%}
                      </select>
                      <span class="svg-wrapper">{{- 'icon-caret.svg' | inline_asset_content -}}</span>
                    </div>
                    <input type="hidden" name="return_to" value="{{ request.full_url }}">
                  {%- endform -%}
                </localization-form>
              {%- endif -%}
            </div>
          {%- endif -%}
        </div>
      </div>
    </div>

    <!-- Mobile Header -->
    <div class="shopify-mobile-header">
      <div class="shopify-container">
        {% render 'shopify-header-drawer' %}

        <div class="shopify-mobile-logo">
          {%- if section.settings.mobile_logo != blank or section.settings.logo != blank -%}
            <a href="{{ routes.root_url }}">
              {%- if section.settings.mobile_logo != blank -%}
                <img src="{{ section.settings.mobile_logo | image_url: width: section.settings.mobile_logo_width }}" alt="{{ shop.name }}" width="{{ section.settings.mobile_logo_width }}" height="auto" class="logo-dark shopify-mobile-logo-img">
                
                {%- if section.settings.mobile_logo_light != blank -%}
                  <img src="{{ section.settings.mobile_logo_light | image_url: width: section.settings.mobile_logo_width }}" alt="{{ shop.name }}" width="{{ section.settings.mobile_logo_width }}" height="auto" class="logo-light shopify-mobile-logo-img">
                {%- else -%}
                  <img src="{{ section.settings.mobile_logo | image_url: width: section.settings.mobile_logo_width }}" alt="{{ shop.name }}" width="{{ section.settings.mobile_logo_width }}" height="auto" class="logo-light shopify-mobile-logo-img">
                {%- endif -%}
              {%- else -%}
                <img src="{{ section.settings.logo | image_url: width: section.settings.mobile_logo_width }}" alt="{{ shop.name }}" width="{{ section.settings.mobile_logo_width }}" height="auto" class="logo-dark shopify-mobile-logo-img">
                
                {%- if section.settings.logo_light != blank -%}
                  <img src="{{ section.settings.logo_light | image_url: width: section.settings.mobile_logo_width }}" alt="{{ shop.name }}" width="{{ section.settings.mobile_logo_width }}" height="auto" class="logo-light shopify-mobile-logo-img">
                {%- else -%}
                  <img src="{{ section.settings.logo | image_url: width: section.settings.mobile_logo_width }}" alt="{{ shop.name }}" width="{{ section.settings.mobile_logo_width }}" height="auto" class="logo-light shopify-mobile-logo-img">
                {%- endif -%}
              {%- endif -%}
            </a>
          {%- else -%}
            <a href="{{ routes.root_url }}" class="shopify-logo-text">{{ shop.name }}</a>
          {%- endif -%}
        </div>

        <div class="shopify-mobile-icons">
          <a href="{{ routes.cart_url }}" class="shopify-icon shopify-icon-cart">
            <svg viewBox="0 0 20 20" class="shopify-icon-svg">
              <path fill="currentColor" d="M8.5 19a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3ZM19 7h-3V6a4 4 0 0 0-8 0v1H5a1 1 0 0 0-1 1v9a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V8a1 1 0 0 0-1-1ZM10 3a3 3 0 0 1 3 3v1h-6V6a3 3 0 0 1 3-3ZM6 17V9h2v8H6Zm4 0V9h2v8h-2Zm4 0V9h2v8h-2Z"/>
            </svg>
            {%- if cart != empty -%}
              <span class="shopify-cart-count">{{ cart.item_count }}</span>
            {%- endif -%}
          </a>
        </div>
      </div>
    </div>

  </header>
</{{ header_tag }}>

{% schema %}
{
  "name": "t:sections.header.name",
  "class": "section-header",
  "settings": [
    {
      "type": "select",
      "id": "desktop_layout",
      "label": "Desktop layout",
      "options": [
        {
          "value": "single-row",
          "label": "Single row"
        },
        {
          "value": "two-row",
          "label": "Two row"
        }
      ],
      "default": "two-row"
    },
    {
      "type": "checkbox",
      "id": "show_top_bar",
      "label": "Show top bar",
      "default": true
    },
    {
      "type": "select",
      "id": "logo_position",
      "label": "Logo position",
      "options": [
        {
          "value": "left",
          "label": "Left"
        },
        {
          "value": "center",
          "label": "Center"
        }
      ],
      "default": "left"
    },
    {
      "type": "select",
      "id": "search_position",
      "label": "Search position",
      "options": [
        {
          "value": "center",
          "label": "Center"
        },
        {
          "value": "right",
          "label": "Right"
        }
      ],
      "default": "center"
    },
    {
      "type": "select",
      "id": "mobile_logo_position",
      "label": "Mobile logo position",
      "options": [
        {
          "value": "left",
          "label": "Left"
        },
        {
          "value": "center",
          "label": "Center"
        }
      ],
      "default": "center"
    },
    {
      "type": "link_list",
      "id": "menu",
      "default": "main-menu",
      "label": "Menu"
    },
    {
      "type": "checkbox",
      "id": "enable_search",
      "default": true,
      "label": "Enable search"
    },
    {
      "type": "checkbox",
      "id": "enable_customer_avatar",
      "default": true,
      "label": "Enable customer account"
    },
    {
      "type": "select",
      "id": "sticky_header_type",
      "options": [
        {
          "value": "none",
          "label": "None"
        },
        {
          "value": "on-scroll-up",
          "label": "On scroll up"
        },
        {
          "value": "always",
          "label": "Always"
        }
      ],
      "default": "on-scroll-up",
      "label": "Sticky header"
    },
    {
      "type": "image_picker",
      "id": "logo",
      "label": "Logo image"
    },
    {
      "type": "range",
      "id": "logo_width",
      "min": 50,
      "max": 300,
      "step": 10,
      "default": 150,
      "unit": "px",
      "label": "Logo width"
    },
    {
      "type": "select",
      "id": "mobile_drawer_order",
      "options": [
        {
          "value": "account-language-menu-help",
          "label": "Account, Language, Menu, Help"
        },
        {
          "value": "menu-account-language-help",
          "label": "Menu, Account, Language, Help"
        },
        {
          "value": "language-account-menu-help",
          "label": "Language, Account, Menu, Help"
        }
      ],
      "default": "account-language-menu-help",
      "label": "Mobile drawer content order"
    }
  ]
}
{% endschema %}